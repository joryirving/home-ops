---
# yaml-language-server: $schema=https://kube-schemas.pages.dev/external-secrets.io/externalsecret_v1.json
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: &name openclaw
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword
  target:
    name: *name
    template:
      data:
        ## Gateway token for authentication
        CLAWDBOT_GATEWAY_TOKEN: "{{ .OPENCLAW_GATEWAY_TOKEN }}"
        ##Discord
        DISCORD_BOT_TOKEN: "{{ .DISCORD_BOT_TOKEN }}"
        ## GH Access
        GITHUB_APP_CLIENT_ID: "{{ .MISO_BOT_CLIENT_ID }}"
        GITHUB_APP_CLIENT_SECRET: "{{ .MISO_BOT_CLIENT_SECRET }}"
        GITHUB_APP_ID: "{{ .MISO_BOT_ID }}"
        GITHUB_APP_INSTALLATION_ID: "{{ .MISO_BOT_INSTALLATION_ID }}"
        GITHUB_APP_PRIVATE_KEY: "{{ .MISO_BOT_PRIVATE_KEY }}"
        ## API Keys
        OPENAI_API_KEY: "{{ .OPENAI_API_KEY }}"
        GOOGLE_AI_STUDIO_API_KEY: "{{ .GOOGLE_GEMINI_API_KEY }}"
        CEREBRAS_API_KEY: "{{ .CEREBRAS_API_KEY }}"
        GROQ_API_KEY: "{{ .GROQ_API_KEY }}"
        MISTRAL_API_KEY: "{{ .MISTRAL_API_KEY }}"
  dataFrom:
    - extract:
        key: openclaw
---
# yaml-language-server: $schema=https://kube-schemas.pages.dev/external-secrets.io/externalsecret_v1.json
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: &name openclaw-config
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword
  target:
    name: *name
    template:
      data:
        ## OpenClaw configuration file
        openclaw.json: |
          {
            "commands": {
              "native": "auto",
              "nativeSkills": "auto"
            },
            "agents": {
              "defaults": {
                "maxConcurrent": 2,
                "timeoutSeconds": 120, // start with 60â€“180 while debugging
                "model": {
                  "primary": "qwen-portal/coder-model",
                  "fallbacks": [
                    "google/gemini-2.5-flash",
                    "google/gemma-3-27b-it",
                    "google/gemini-3-flash",
                    "k8s-cpu/gpt-oss:120b",
                    "smurf/voytas26/openclaw-oss-20b-deterministic:latest",
                    "k8s/gpt-oss:20b"
                  ]
                },
                "imageModel": {
                  "primary": "k8s/llava:13b",
                  "fallbacks": [
                    "smurf/llava:13b",
                    "qwen-portal/vision-model"
                  ]
                },
                "models": {
                  "qwen-portal/coder-model": { "alias": "qwen"},
                  "qwen-portal/vision-model": {},
                  "smurf/voytas26/openclaw-oss-20b-deterministic:latest": {"alias": "smurf"},
                  "smurf/voytas26/openclaw-qwen3vl-8b-opt:latest": {"alias": "smurf-qwen"},
                  "smurf/deepseek-r1:14b": {},
                  "smurf/llava:13b": {},
                  "smurf/MrScratchcat22/GLM-4.7-Flash-REAP-23B-A3B:latest": { "alias": "glm"},
                  "smurf/qwen3:14b": {},
                  "k8s/llava:13b": {},
                  "k8s/gpt-oss:20b": {
                    "alias": "k8s"
                  },
                  "k8s-cpu/gpt-oss:120b": {
                    "alias": "cpu"
                  },
                  "k8s-cpu/qwen2.5-coder:32b": {},
                  "k8s-cpu/llama3.3:70b": {},
                  "k8s-cpu/deepseek-r1:70b": {},
                  "google/gemini-3-flash": {},
                  "google/gemma-3-27b-it": {},
                  "google/gemini-2.5-flash": {}
                },
                "memorySearch": {
                  "provider": "gemini",
                  "model": "gemini-embedding-001",
                  "fallback": "local",
                  "local": {
                    "modelPath": "hf:ggml-org/embeddinggemma-300M-GGUF/embeddinggemma-300M-Q8_0.gguf"
                  },
                  "sync": {
                    "watch": true
                  },
                  "query": {
                    "hybrid": {
                      "enabled": true,
                      "vectorWeight": 0.7,
                      "textWeight": 0.3
                    }
                  }
                }
              }
            },
            "models": {
              "providers": {
                "qwen-portal": {
                  "baseUrl": "https://portal.qwen.ai/v1",
                  "apiKey": "qwen-oauth",
                  "api": "openai-completions",
                  "models": [
                    {
                      "id": "coder-model",
                      "name": "Qwen Coder",
                      "reasoning": false,
                      "input": [
                        "text"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 128000,
                      "maxTokens": 8192
                    },
                    {
                      "id": "vision-model",
                      "name": "Qwen Vision",
                      "reasoning": false,
                      "input": [
                        "text",
                        "image"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 128000,
                      "maxTokens": 8192
                    }
                  ]
                },
                "google": {
                  "baseUrl": "https://generativelanguage.googleapis.com/v1beta",
                  "apiKey": "{{ .GOOGLE_GEMINI_API_KEY }}",
                  "api": "google-generative-ai",
                  "models": [
                    {
                      "id": "gemini-3-flash",
                      "name": "Gemini 3 Flash",
                      "reasoning": false,
                      "input": [
                        "text"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 32760,
                      "maxTokens": 8192
                    },
                    {
                      "id": "gemini-2.5-flash",
                      "name": "Gemini 2.5 Flash",
                      "reasoning": false,
                      "input": [
                        "text"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 32760,
                      "maxTokens": 8192
                    },
                    {
                      "id": "gemma-3-27b-it",
                      "name": "Gemma 3 27B",
                      "reasoning": false,
                      "input": [
                        "text"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 32760,
                      "maxTokens": 8192
                    }
                  ]
                },
                "smurf": {
                  "baseUrl": "http://smurf-pc:11434/v1",
                  "apiKey": "smurf",
                  "api": "openai-completions",
                  "models": [
                    {
                      "id": "MrScratchcat22/GLM-4.7-Flash-REAP-23B-A3B:latest",
                      "name": "GLM-4.7 Flash REAP-23B-A3B",
                      "reasoning": false,
                      "input": [
                        "text"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 32768,
                      "maxTokens": 8192
                    },
                    {
                      "id": "qwen3:14b",
                      "name": "Qwen3 14B",
                      "reasoning": false,
                      "input": [
                        "text"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 32768,
                      "maxTokens": 8192
                    },
                    {
                      "id": "deepseek-r1:14b",
                      "name": "DeepSeek R1 14B",
                      "reasoning": false,
                      "input": [
                        "text"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 32768,
                      "maxTokens": 8192
                    },
                    {
                      "id": "llava:13b",
                      "name": "LLaVA 13B",
                      "reasoning": false,
                      "input": [
                        "text",
                        "image"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 4096,
                      "maxTokens": 8192
                    },
                    {
                      "id": "voytas26/openclaw-qwen3vl-8b-opt:latest",
                      "name": "OpenClaw OSS qwen3 Deterministic",
                      "reasoning": false,
                      "input": [
                        "text"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 131072,
                      "maxTokens": 8192
                    },
                    {
                      "id": "voytas26/openclaw-oss-20b-deterministic:latest",
                      "name": "OpenClaw OSS 20B Deterministic",
                      "reasoning": false,
                      "input": [
                        "text"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 131072,
                      "maxTokens": 8192
                    }
                  ]
                },
                "k8s": {
                  "baseUrl": "http://ollama.llm:11434/v1",
                  "apiKey": "k8s",
                  "api": "openai-completions",
                  "models": [
                    {
                      "id": "gpt-oss:20b",
                      "name": "GPT-OSS 20B",
                      "reasoning": true,
                      "input": [
                        "text"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 131072,
                      "maxTokens": 2880
                    },
                    {
                      "id": "llava:13b",
                      "name": "LLaVA 13B",
                      "reasoning": false,
                      "input": [
                        "text",
                        "image"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 4096,
                      "maxTokens": 8192
                    }
                  ]
                },
                "k8s-cpu": {
                  "baseUrl": "http://ollama-cpu.llm:11434/v1",
                  "apiKey": "k8s",
                  "api": "openai-completions",
                  "models": [
                    {
                      "id": "gpt-oss:120b",
                      "name": "GPT-OSS 20B",
                      "reasoning": true,
                      "input": [
                        "text"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 131072,
                      "maxTokens": 2880
                    },
                    {
                      "id": "qwen2.5-coder:32b",
                      "name": "Qwen2.5 Coder 32B",
                      "reasoning": false,
                      "input": [
                        "text"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 32768,
                      "maxTokens": 5120
                    },
                    {
                      "id": "llama3.3:70b",
                      "name": "Llama3.3 70B",
                      "reasoning": false,
                      "input": [
                        "text"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 131072,
                      "maxTokens": 8192
                    },
                    {
                      "id": "deepseek-r1:70b",
                      "name": "DeepSeek R1 70B",
                      "reasoning": true,
                      "input": [
                        "text"
                      ],
                      "cost": {
                        "input": 0,
                        "output": 0,
                        "cacheRead": 0,
                        "cacheWrite": 0
                      },
                      "contextWindow": 131072,
                      "maxTokens": 8192
                    }
                  ]
                }
              }
            },
            "auth": {
              "profiles": {
                "qwen-portal:default": {
                  "provider": "qwen-portal",
                  "mode": "oauth"
                },
                "smurf:default": {
                  "provider": "smurf",
                  "mode": "api_key"
                },
                "k8s:default": {
                  "provider": "k8s",
                  "mode": "api_key"
                },
                "k8s-cpu:default": {
                  "provider": "k8s-cpu",
                  "mode": "api_key"
                }
              }
            },
            "hooks": {
              "enabled": true,
              "path": "/webhooks",
              "token": "{{ .GITHUB_WEBHOOK_SECRET }}",
              "maxBodyBytes": 262144,
              "transformsDir": "/home/node/.openclaw/workspace",
              "mappings": [
                {
                  "id": "github-pr-notifications",
                  "match": {
                    "path": "github"
                  },
                  "action": "agent",
                  "wakeMode": "now",
                  "name": "GitHub PR Handler",
                  "transform": {
                    "module": "./github-webhook-transform.js"
                  }
                }
              ]
            },
            "plugins": {
              "entries": {
                "discord": {
                  "enabled": true
                },
                "qwen-portal-auth": {
                  "enabled": true
                }
              }
            },
            "session": {
              "dmScope": "per-channel-peer"
            },
            "gateway": {
              "mode": "local",
              "auth": {
                "mode": "token",
                "token": "{{ .OPENCLAW_GATEWAY_TOKEN }}"
              },
              "port": 18789,
              "bind": "loopback",
              "tailscale": {
                "mode": "off",
                "resetOnExit": false
              },
              "trustedProxies": ["10.42.0.0/16", "192.168.0.0/16"]
            },
            "messages": {
              "ackReactionScope": "group-mentions",
              "responsePrefix": "[{provider}/{model} | think:{thinkingLevel}]"
            },
            "wizard": {
              "lastRunAt": "2026-01-30T18:09:59.466Z",
              "lastRunVersion": "2026.1.29",
              "lastRunCommand": "onboard",
              "lastRunMode": "local"
            }
          }
  dataFrom:
    - extract:
        key: openclaw
